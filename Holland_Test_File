<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éœå…°å¾·èŒä¸šå…´è¶£æµ‹è¯•</title>
    <style>
        /* å…¨å±€æ ·å¼ */
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }

        /* å¤´éƒ¨æ ·å¼ */
        .header {
            background: linear-gradient(135deg, var(--dark-color), #34495e);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 1rem;
        }

        /* è¯´æ˜åŒºåŸŸ */
        .instructions {
            background: var(--light-color);
            border-left: 4px solid var(--primary-color);
            padding: 1.5rem;
            margin: 1.5rem;
            border-radius: var(--border-radius);
        }

        .instructions h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .instructions h3 i {
            font-size: 1.2rem;
        }

        .rating-scale {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .scale-item {
            background: white;
            padding: 1rem;
            border-radius: var(--border-radius);
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
        }

        .scale-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .scale-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--dark-color);
            margin-bottom: 0.5rem;
        }

        .scale-label {
            font-size: 0.9rem;
            color: #666;
        }

        /* æµ‹è¯•å†…å®¹åŒºåŸŸ */
        .test-content {
            padding: 1.5rem;
        }

        .section {
            margin-bottom: 2rem;
            background: #f8f9fa;
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 1px solid #e9ecef;
        }

        .section-header {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 1rem 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }

        .section-header.type-I { background: linear-gradient(135deg, #3498db, #2980b9); }
        .section-header.type-A { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
        .section-header.type-S { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .section-header.type-E { background: linear-gradient(135deg, #f39c12, #d35400); }
        .section-header.type-C { background: linear-gradient(135deg, #1abc9c, #16a085); }

        .section-title {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.1rem;
        }

        .type-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .toggle-icon {
            transition: transform 0.3s ease;
        }

        .section-content {
            padding: 1.5rem;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 1rem;
        }

        /* é—®é¢˜å¡ç‰‡ */
        .question-card {
            background: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid #e9ecef;
            transition: var(--transition);
        }

        .question-card:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        .question-header {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .question-number {
            background: var(--primary-color);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .question-text {
            font-size: 1rem;
            font-weight: 500;
            color: var(--dark-color);
            line-height: 1.4;
        }

        /* é€‰é¡¹æ ·å¼ - ä¿®å¤åçš„æ ·å¼ */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.8rem;
        }

        .option-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem 0.5rem;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            user-select: none;
        }

        .option-label:hover {
            background: #e9ecef;
            border-color: var(--primary-color);
        }

        .option-label.selected {
            background: #e3f2fd;
            border-color: var(--primary-color);
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.2);
        }

        .option-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--dark-color);
            margin-bottom: 0.3rem;
        }

        .option-text {
            font-size: 0.85rem;
            color: #666;
        }

        .radio-input {
            display: none;
        }

        /* æ§åˆ¶æ  */
        .controls {
            background: white;
            padding: 1.5rem;
            border-top: 1px solid #e9ecef;
            position: sticky;
            bottom: 0;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 2rem;
        }

        .progress-container {
            flex: 1;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
            border-radius: 5px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #666;
        }

        .submit-btn {
            background: linear-gradient(135deg, var(--secondary-color), #27ae60);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: var(--border-radius);
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 204, 113, 0.3);
        }

        .submit-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .section-content {
                grid-template-columns: 1fr;
            }
            
            .options-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            }
            
            .controls {
                flex-direction: column;
                gap: 1rem;
            }
            
            .progress-container {
                width: 100%;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ç»“æœå±•ç¤ºåŒºåŸŸ */
        .result-container {
            display: none;
            padding: 2rem;
            background: #f8f9fa;
            border-radius: var(--border-radius);
            margin: 1.5rem;
        }

        .result-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .result-header h2 {
            color: var(--dark-color);
            margin-bottom: 0.5rem;
        }

        .primary-type {
            background: linear-gradient(135deg, var(--primary-color), var(--dark-color));
            color: white;
            padding: 2rem;
            border-radius: var(--border-radius);
            text-align: center;
            margin: 2rem 0;
        }

        .type-scores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .score-card {
            background: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .score-card.highlight {
            border: 2px solid var(--primary-color);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.2);
        }

        .score-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--dark-color);
            margin: 0.5rem 0;
        }

        .restart-btn {
            background: var(--warning-color);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: var(--border-radius);
            font-size: 1rem;
            cursor: pointer;
            margin-top: 1rem;
        }

        .restart-btn:hover {
            background: #e67e22;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>éœå…°å¾·èŒä¸šå…´è¶£æµ‹è¯•</h1>
            <p class="subtitle">æ¢ç´¢æ‚¨çš„èŒä¸šå…´è¶£ç±»å‹ï¼Œæ‰¾åˆ°é€‚åˆæ‚¨çš„èŒä¸šæ–¹å‘</p>
        </div>
        
        <div class="instructions">
            <h3><i>ğŸ’¡</i> æµ‹è¯•è¯´æ˜</h3>
            <p>æœ¬æµ‹è¯•åŸºäºéœå…°å¾·èŒä¸šå…´è¶£ç†è®ºï¼Œé€šè¿‡è¯„ä¼°æ‚¨å¯¹60ç§ä¸åŒç±»å‹æ´»åŠ¨çš„å–œå¥½ç¨‹åº¦ï¼Œå¸®åŠ©æ‚¨äº†è§£è‡ªå·±çš„èŒä¸šå…´è¶£å€¾å‘ã€‚</p>
            <p>è¯·æ ¹æ®æ‚¨çš„çœŸå®æ„Ÿå—ï¼Œå¯¹æ¯ä¸ªæ´»åŠ¨è¿›è¡Œè¯„åˆ†ï¼š</p>
            
            <div class="rating-scale" id="ratingScale">
                <!-- è¯„åˆ†å°ºåº¦å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
            </div>
        </div>
        
        <div class="test-content" id="testContent">
            <!-- æµ‹è¯•é¢˜ç›®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
        
        <div class="controls">
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text">
                    <span>å®Œæˆè¿›åº¦: <span id="progressText">0%</span></span>
                    <span>å·²ç­”: <span id="answeredCount">0</span>/<span id="totalCount">60</span></span>
                </div>
            </div>
            <button class="submit-btn" id="submitBtn" disabled>
                <span>æäº¤æµ‹è¯•</span>
                <span>âœ“</span>
            </button>
        </div>
        
        <div class="result-container" id="resultContainer">
            <!-- ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
        </div>
    </div>
    
    <div class="loading" id="loading">
        <div class="spinner"></div>
    </div>

    <script>
        // å®šä¹‰éœå…°å¾·æµ‹è¯•æ•°æ®ç»“æ„å’Œé€»è¾‘
        class HollandTest {
            constructor() {
                this.userAnswers = new Map();
                this.testData = [];
                this.currentSelections = new Array(60).fill(0); // åˆå§‹åŒ–ä¸º0ï¼Œè¡¨ç¤ºæœªé€‰æ‹©
                this.initializeData();
                this.initializeUI();
            }
            
            initializeData() {
                // å®šä¹‰è¯„åˆ†é€‰é¡¹
                this.ratingOptions = [
                    { value: 1, label: 'éå¸¸ä¸å–œæ¬¢' },
                    { value: 2, label: 'ä¸å–œæ¬¢' },
                    { value: 3, label: 'ä¸ç¡®å®š' },
                    { value: 4, label: 'å–œæ¬¢' },
                    { value: 5, label: 'éå¸¸å–œæ¬¢' }
                ];
                
                // å®šä¹‰æµ‹è¯•ç±»å‹
                this.types = [
                    { code: 'R', name: 'å®é™…å‹', desc: 'å–œæ¬¢åŠ¨æ‰‹æ“ä½œã€æœºæ¢°ã€æŠ€æœ¯ç±»å·¥ä½œ', color: '#e74c3c' },
                    { code: 'I', name: 'ç ”ç©¶å‹', desc: 'å–œæ¬¢æ€è€ƒã€ç ”ç©¶ã€åˆ†æçš„å·¥ä½œ', color: '#3498db' },
                    { code: 'A', name: 'è‰ºæœ¯å‹', desc: 'å–œæ¬¢åˆ›é€ ã€è¡¨è¾¾ã€è‰ºæœ¯æ€§çš„å·¥ä½œ', color: '#9b59b6' },
                    { code: 'S', name: 'ç¤¾ä¼šå‹', desc: 'å–œæ¬¢å¸®åŠ©ã€æ•™è‚²ã€æœåŠ¡ä»–äººçš„å·¥ä½œ', color: '#2ecc71' },
                    { code: 'E', name: 'ä¼ä¸šå‹', desc: 'å–œæ¬¢é¢†å¯¼ã€é”€å”®ã€ç®¡ç†çš„å·¥ä½œ', color: '#f39c12' },
                    { code: 'C', name: 'å¸¸è§„å‹', desc: 'å–œæ¬¢æœ‰æ¡ç†ã€ç³»ç»ŸåŒ–ã€ç»†è‡´çš„å·¥ä½œ', color: '#1abc9c' }
                ];
                
                // æ¨¡æ‹Ÿä»ExcelåŠ è½½çš„æµ‹è¯•æ•°æ®
                this.loadTestData();
            }
            
            loadTestData() {
                // æ¨¡æ‹ŸExcelæ•°æ®ç»“æ„
                const excelData = `
                    å®é™…å‹ï¼ˆRï¼‰æ´»åŠ¨
                    1|ä¿®ç†è‡ªè¡Œè½¦ã€ç”µå™¨|R
                    2|ä½¿ç”¨ä¸‡ç”¨è¡¨ã€èºä¸åˆ€ç­‰å·¥å…·|R
                    3|æ“ä½œæœºåºŠã€æœºæ¢°è®¾å¤‡|R
                    4|é©¾é©¶æ±½è½¦ã€å¡è½¦|R
                    5|ç»„è£…å®¶å…·æˆ–æ¨¡å‹|R
                    6|è¿›è¡Œæœ¨å·¥ã€ç„Šæ¥|R
                    7|é˜…è¯»æŠ€æœ¯æ‰‹å†Œã€å›¾çº¸|R
                    8|ç§æ¤èŠ±è‰ã€å…»æ®–åŠ¨ç‰©|R
                    9|è¿›è¡Œæˆ·å¤–å‹˜æ¢ã€æµ‹é‡|R
                    10|ç»´æŠ¤å’Œä¿®ç†æˆ¿å±‹|R
                    ç ”ç©¶å‹ï¼ˆIï¼‰æ´»åŠ¨
                    11|åœ¨å®éªŒå®¤åšå®éªŒ|I
                    12|ç ”ç©¶ç§‘å­¦ç†è®º|I
                    13|è§£æ•°å­¦éš¾é¢˜ã€é€»è¾‘æ¸¸æˆ|I
                    14|åˆ†ææ•°æ®ã€åˆ¶ä½œå›¾è¡¨|I
                    15|é˜…è¯»å­¦æœ¯æœŸåˆŠã€è®ºæ–‡|I
                    16|ä½¿ç”¨æ˜¾å¾®é•œã€æœ›è¿œé•œè§‚æµ‹|I
                    17|ç¼–å†™è®¡ç®—æœºç¨‹åº|I
                    18|ç ”ç©¶åŠ¨æ¤ç‰©åˆ†ç±»|I
                    19|æ¢è®¨å“²å­¦é—®é¢˜|I
                    20|è®¾è®¡å¤æ‚çš„æ¨¡å‹|I
                    è‰ºæœ¯å‹ï¼ˆAï¼‰æ´»åŠ¨
                    21|ç»˜ç”»ã€ç´ æ|A
                    22|æ¼”å¥ä¹å™¨ã€ä½œæ›²|A
                    23|å†™ä½œè¯—æ­Œã€å°è¯´|A
                    24|è®¾è®¡æµ·æŠ¥ã€æœè£…|A
                    25|è¡¨æ¼”æˆå‰§ã€èˆè¹ˆ|A
                    26|æ‘„å½±ã€æ‹æ‘„å½±ç‰‡|A
                    27|é™¶è‰ºã€é›•åˆ»|A
                    28|æ¬£èµè‰ºæœ¯å±•è§ˆ|A
                    29|å®¤å†…è£…é¥°è®¾è®¡|A
                    30|åˆ›æ„çƒ¹é¥ªã€ç³•ç‚¹åˆ¶ä½œ|A
                    ç¤¾ä¼šå‹ï¼ˆSï¼‰æ´»åŠ¨
                    31|å¸®åŠ©ä»–äººè§£å†³é—®é¢˜|S
                    32|ç…§é¡¾ç—…äººã€å„¿ç«¥|S
                    33|æ•™å¯¼åˆ«äººçŸ¥è¯†æŠ€èƒ½|S
                    34|å‚åŠ å¿—æ„¿æœåŠ¡|S
                    35|è°ƒè§£ä»–äººçŸ›ç›¾|S
                    36|ç»„ç»‡é›†ä½“æ´»åŠ¨|S
                    37|ä¸é™Œç”Ÿäººè½»æ¾äº¤è°ˆ|S
                    38|ç»™äºˆä»–äººæƒ…æ„Ÿæ”¯æŒ|S
                    39|åœ¨ç¤¾å›¢ä¸­æ‹…ä»»èŒåŠ¡|S
                    40|ä¸ºå…¬ç›Šäº‹ä¸šç­¹æ¬¾|S
                    ä¼ä¸šå‹ï¼ˆEï¼‰æ´»åŠ¨
                    41|æ¨é”€äº§å“æˆ–æƒ³æ³•|E
                    42|é¢†å¯¼å›¢é˜Ÿå®Œæˆé¡¹ç›®|E
                    43|ç­–åˆ’å•†ä¸šæ´»åŠ¨|E
                    44|è¿›è¡ŒæŠ•èµ„åˆ†æ|E
                    45|å‚åŠ è¾©è®ºã€æ¼”è®²æ¯”èµ›|E
                    46|åˆ›ä¸šã€å¼€åŠå…¬å¸|E
                    47|ç®¡ç†å‘˜å·¥ã€åˆ†é…ä»»åŠ¡|E
                    48|åˆ†æå¸‚åœºè¶‹åŠ¿|E
                    49|äº‰å–èŒä½æ™‹å‡|E
                    50|è¿›è¡Œå•†åŠ¡è°ˆåˆ¤|E
                    å¸¸è§„å‹ï¼ˆCï¼‰æ´»åŠ¨
                    51|æ•´ç†æ–‡ä»¶ã€å½’æ¡£|C
                    52|æ ¸å¯¹æ•°æ®ã€ç¡®ä¿å‡†ç¡®|C
                    53|æ“ä½œåŠå…¬è½¯ä»¶å¤„ç†æ–‡æ¡£|C
                    54|åˆ¶å®šè¯¦ç»†å·¥ä½œè®¡åˆ’|C
                    55|è®°å½•ä¼šè®®çºªè¦|C
                    56|æŒ‰ç…§æµç¨‹æ“ä½œåŠå…¬è®¾å¤‡|C
                    57|ç¼–åˆ¶è´¢åŠ¡æŠ¥è¡¨|C
                    58|ç»´æŠ¤æ•°æ®åº“ä¿¡æ¯|C
                    59|æ’°å†™è§„èŒƒçš„å·¥ä½œæŠ¥å‘Š|C
                    60|æ‰§è¡Œæ ‡å‡†åŒ–ä½œä¸šæµç¨‹|C
                `.trim().split('\n');
                
                let currentType = null;
                this.testData = [];
                
                excelData.forEach(line => {
                    if (line.includes('å®é™…å‹')) currentType = 'R';
                    else if (line.includes('ç ”ç©¶å‹')) currentType = 'I';
                    else if (line.includes('è‰ºæœ¯å‹')) currentType = 'A';
                    else if (line.includes('ç¤¾ä¼šå‹')) currentType = 'S';
                    else if (line.includes('ä¼ä¸šå‹')) currentType = 'E';
                    else if (line.includes('å¸¸è§„å‹')) currentType = 'C';
                    else {
                        const parts = line.split('|');
                        if (parts.length >= 3) {
                            this.testData.push({
                                id: parseInt(parts[0]),
                                text: parts[1],
                                type: parts[2]
                            });
                        }
                    }
                });
            }
            
            initializeUI() {
                this.renderRatingScale();
                this.renderTestSections();
                this.attachEventListeners();
                this.updateProgress();
            }
            
            renderRatingScale() {
                const ratingScale = document.getElementById('ratingScale');
                ratingScale.innerHTML = this.ratingOptions.map(option => `
                    <div class="scale-item">
                        <div class="scale-value">${option.value}</div>
                        <div class="scale-label">${option.label}</div>
                    </div>
                `).join('');
            }
            
            renderTestSections() {
                const testContent = document.getElementById('testContent');
                testContent.innerHTML = ''; // æ¸…ç©ºå†…å®¹
                
                this.types.forEach(type => {
                    const typeQuestions = this.testData.filter(q => q.type === type.code);
                    
                    if (typeQuestions.length === 0) return;
                    
                    const sectionHTML = `
                        <div class="section">
                            <div class="section-header type-${type.code}" onclick="window.hollandTest.toggleSection('${type.code}')">
                                <div class="section-title">
                                    <span class="type-badge">${type.code}</span>
                                    <span>${type.name} (${type.code})</span>
                                    <small>${type.desc}</small>
                                </div>
                                <div class="toggle-icon">âˆ’</div>
                            </div>
                            <div class="section-content" id="section-${type.code}">
                                ${typeQuestions.map(question => `
                                    <div class="question-card" id="question-${question.id}">
                                        <div class="question-header">
                                            <div class="question-number">${question.id}</div>
                                            <div class="question-text">${question.text}</div>
                                        </div>
                                        <div class="options-grid">
                                            ${this.ratingOptions.map(option => `
                                                <label class="option-label" onclick="window.hollandTest.selectAnswer(${question.id}, ${option.value})">
                                                    <input type="radio" 
                                                           class="radio-input" 
                                                           name="q${question.id}" 
                                                           value="${option.value}">
                                                    <div class="option-value">${option.value}</div>
                                                    <div class="option-text">${option.label}</div>
                                                </label>
                                            `).join('')}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                    
                    testContent.innerHTML += sectionHTML;
                });
                
                // è®¾ç½®æ€»é¢˜ç›®æ•°
                document.getElementById('totalCount').textContent = this.testData.length;
            }
            
            toggleSection(typeCode) {
                const section = document.getElementById(`section-${typeCode}`);
                const icon = document.querySelector(`.section-header.type-${typeCode} .toggle-icon`);
                
                if (section.style.display === 'none') {
                    section.style.display = 'grid';
                    icon.textContent = 'âˆ’';
                } else {
                    section.style.display = 'none';
                    icon.textContent = '+';
                }
            }
            
            // ä¿®å¤çš„selectAnsweræ–¹æ³•
            selectAnswer(questionId, value) {
                console.log(`é€‰æ‹©é¢˜ç›® ${questionId}, å€¼ ${value}`);
                
                // æ›´æ–°å½“å‰é€‰æ‹©
                this.currentSelections[questionId - 1] = value;
                
                // æ‰¾åˆ°å¯¹åº”çš„é¢˜ç›®å¡ç‰‡
                const questionCard = document.getElementById(`question-${questionId}`);
                if (!questionCard) {
                    console.error(`æ‰¾ä¸åˆ°é¢˜ç›® ${questionId} çš„å¡ç‰‡`);
                    return;
                }
                
                // æ›´æ–°æ‰€æœ‰é€‰é¡¹çš„é€‰ä¸­çŠ¶æ€
                const options = questionCard.querySelectorAll('.option-label');
                options.forEach(option => {
                    const optionValue = parseInt(option.querySelector('.option-value').textContent);
                    const radioInput = option.querySelector('input[type="radio"]');
                    
                    if (optionValue === value) {
                        option.classList.add('selected');
                        radioInput.checked = true;
                    } else {
                        option.classList.remove('selected');
                        radioInput.checked = false;
                    }
                });
                
                // æ›´æ–°è¿›åº¦
                this.updateProgress();
                
                // è°ƒè¯•ä¿¡æ¯
                console.log(`é¢˜ç›® ${questionId}: é€‰æ‹©äº† ${value}`);
                console.log('å½“å‰é€‰æ‹©æ•°ç»„:', this.currentSelections);
            }
            
            updateProgress() {
                const answered = this.currentSelections.filter(v => v > 0).length;
                const total = this.testData.length;
                const percentage = Math.round((answered / total) * 100);
                
                document.getElementById('answeredCount').textContent = answered;
                document.getElementById('progressText').textContent = `${percentage}%`;
                document.getElementById('progressFill').style.width = `${percentage}%`;
                
                // æ›´æ–°æäº¤æŒ‰é’®çŠ¶æ€
                const submitBtn = document.getElementById('submitBtn');
                submitBtn.disabled = answered < total;
                
                // å¦‚æœå…¨éƒ¨å®Œæˆï¼Œé«˜äº®æäº¤æŒ‰é’®
                if (answered === total) {
                    submitBtn.style.background = 'linear-gradient(135deg, #2ecc71, #27ae60)';
                }
            }
            
            calculateResults() {
                const typeScores = {
                    'R': 0, 'I': 0, 'A': 0, 'S': 0, 'E': 0, 'C': 0
                };
                
                // è®¡ç®—å„ç±»å‹æ€»åˆ†
                this.testData.forEach(question => {
                    const score = this.currentSelections[question.id - 1];
                    if (score > 0) {
                        typeScores[question.type] += score;
                    }
                });
                
                // æ’åºç±»å‹
                const sortedTypes = Object.entries(typeScores)
                    .sort(([,a], [,b]) => b - a)
                    .map(([type, score]) => ({ type, score }));
                
                return { typeScores, sortedTypes };
            }
            
            showResults() {
                const results = this.calculateResults();
                
                // æ„å»ºç»“æœHTML
                const primaryType = results.sortedTypes[0];
                const typeInfo = this.types.find(t => t.code === primaryType.type);
                
                let resultsHTML = `
                    <div class="result-header">
                        <h2>éœå…°å¾·æµ‹è¯•ç»“æœ</h2>
                        <p>åŸºäºæ‚¨çš„é€‰æ‹©ï¼Œä»¥ä¸‹æ˜¯æ‚¨çš„èŒä¸šå…´è¶£ç±»å‹åˆ†æ</p>
                    </div>
                    
                    <div class="primary-type">
                        <h3>æ‚¨çš„é¦–è¦å…´è¶£ç±»å‹</h3>
                        <div style="font-size: 2rem; font-weight: bold; margin: 1rem 0;">${typeInfo.name} (${typeInfo.code})</div>
                        <p>${typeInfo.desc}</p>
                    </div>
                    
                    <div class="type-scores">
                `;
                
                results.sortedTypes.forEach(item => {
                    const info = this.types.find(t => t.code === item.type);
                    const percentage = Math.round((item.score / 50) * 100);
                    const isPrimary = item.type === primaryType.type;
                    
                    resultsHTML += `
                        <div class="score-card ${isPrimary ? 'highlight' : ''}">
                            <div style="font-size: 0.9rem; color: #666;">${info.name}</div>
                            <div class="score-value">${item.score}</div>
                            <div style="font-size: 0.9rem; color: #666;">
                                ${percentage}% (${item.score}/50)
                            </div>
                            <div style="height: 8px; background: #e9ecef; border-radius: 4px; margin-top: 0.5rem; overflow: hidden;">
                                <div style="height: 100%; width: ${percentage}%; background: ${info.color}; border-radius: 4px;"></div>
                            </div>
                        </div>
                    `;
                });
                
                resultsHTML += `
                    </div>
                    <div style="text-align: center; margin-top: 2rem;">
                        <button class="restart-btn" onclick="window.hollandTest.restartTest()">é‡æ–°æµ‹è¯•</button>
                    </div>
                `;
                
                document.getElementById('resultContainer').innerHTML = resultsHTML;
                document.getElementById('resultContainer').style.display = 'block';
                
                // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
                document.getElementById('resultContainer').scrollIntoView({ behavior: 'smooth' });
                
                // è¾“å‡ºç»“æœåˆ°æ§åˆ¶å°ï¼ˆä¾›Cozeå·¥ä½œæµä½¿ç”¨ï¼‰
                console.log('éœå…°å¾·æµ‹è¯•ç»“æœæ•°ç»„:', this.currentSelections);
                
                // è¾“å‡ºåˆ°å…¨å±€å˜é‡ï¼ˆä¾›Cozeå·¥ä½œæµæå–ï¼‰
                window.Holland_Test_Result = this.currentSelections;
                
                // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼Œé€šçŸ¥å¤–éƒ¨ç³»ç»Ÿ
                const event = new CustomEvent('holland-test-completed', {
                    detail: {
                        Holland_Test_Result: this.currentSelections,
                        typeScores: results.typeScores,
                        primaryType: primaryType
                    }
                });
                window.dispatchEvent(event);
            }
            
            submitTest() {
                const answered = this.currentSelections.filter(v => v > 0).length;
                const total = this.testData.length;
                
                if (answered < total) {
                    alert(`æ‚¨è¿˜æœ‰ ${total - answered} é“é¢˜ç›®æœªå®Œæˆï¼Œè¯·å®Œæˆæ‰€æœ‰é¢˜ç›®åå†æäº¤ã€‚`);
                    return;
                }
                
                // éªŒè¯æ‰€æœ‰é€‰æ‹©éƒ½åœ¨1-5ä¹‹é—´
                for (let i = 0; i < this.currentSelections.length; i++) {
                    const score = this.currentSelections[i];
                    if (score < 1 || score > 5) {
                        alert(`ç¬¬ ${i + 1} é¢˜çš„é€‰æ‹©æ— æ•ˆï¼Œè¯·é€‰æ‹©1-5ä¹‹é—´çš„è¯„åˆ†ã€‚`);
                        return;
                    }
                }
                
                // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
                document.getElementById('loading').style.display = 'flex';
                
                // æ¨¡æ‹Ÿè®¡ç®—è¿‡ç¨‹
                setTimeout(() => {
                    document.getElementById('loading').style.display = 'none';
                    this.showResults();
                }, 1000);
            }
            
            restartTest() {
                // é‡ç½®æ‰€æœ‰æ•°æ®
                this.currentSelections = new Array(60).fill(0);
                this.userAnswers.clear();
                
                // é‡ç½®UI
                document.querySelectorAll('.option-label').forEach(option => {
                    option.classList.remove('selected');
                });
                
                document.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.checked = false;
                });
                
                // éšè—ç»“æœ
                document.getElementById('resultContainer').style.display = 'none';
                
                // é‡ç½®è¿›åº¦
                this.updateProgress();
                
                // æ»šåŠ¨åˆ°é¡¶éƒ¨
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // æ¸…é™¤å…¨å±€å˜é‡
                window.Holland_Test_Result = null;
            }
            
            attachEventListeners() {
                // æäº¤æŒ‰é’®äº‹ä»¶
                document.getElementById('submitBtn').addEventListener('click', () => {
                    this.submitTest();
                });
                
                // é”®ç›˜å¿«æ·é”®æ”¯æŒ
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && !document.getElementById('submitBtn').disabled) {
                        this.submitTest();
                    }
                });
            }
        }
        
        // åˆå§‹åŒ–éœå…°å¾·æµ‹è¯•
        let hollandTest;
        
        document.addEventListener('DOMContentLoaded', () => {
            hollandTest = new HollandTest();
            
            // æš´éœ²ç»™å…¨å±€
            window.hollandTest = hollandTest;
            
            // ç›‘å¬æµ‹è¯•å®Œæˆäº‹ä»¶
            window.addEventListener('holland-test-completed', (event) => {
                console.log('éœå…°å¾·æµ‹è¯•å®Œæˆï¼Œç»“æœ:', event.detail);
            });
        });
        
        // ä¾›Cozeå·¥ä½œæµè°ƒç”¨çš„æ¥å£å‡½æ•°
        function getHollandTestResult() {
            if (!window.hollandTest) {
                return {
                    success: false,
                    error: 'æµ‹è¯•æœªåˆå§‹åŒ–',
                    Holland_Test_Result: []
                };
            }
            
            const selections = window.hollandTest.currentSelections;
            const answered = selections.filter(v => v > 0).length;
            
            if (answered < 60) {
                return {
                    success: false,
                    error: `è¿˜æœ‰ ${60 - answered} é“é¢˜ç›®æœªå®Œæˆ`,
                    Holland_Test_Result: []
                };
            }
            
            // è®¡ç®—ç±»å‹åˆ†æ•°
            const results = window.hollandTest.calculateResults();
            
            return {
                success: true,
                Holland_Test_Result: selections,
                typeScores: results.typeScores,
                sortedTypes: results.sortedTypes,
                answeredCount: answered,
                totalCount: 60
            };
        }
        
        // æ¨¡æ‹Ÿç”¨æˆ·å®Œæˆæµ‹è¯•çš„å‡½æ•°ï¼ˆç”¨äºæµ‹è¯•ï¼‰
        function simulateCompleteTest() {
            // éšæœºç”Ÿæˆæµ‹è¯•ç­”æ¡ˆ
            const randomSelections = Array.from({length: 60}, () => Math.floor(Math.random() * 5) + 1);
            
            // è®¾ç½®æ‰€æœ‰ç­”æ¡ˆ
            randomSelections.forEach((score, index) => {
                const questionId = index + 1;
                hollandTest.selectAnswer(questionId, score);
            });
            
            // æäº¤æµ‹è¯•
            setTimeout(() => {
                hollandTest.submitTest();
            }, 500);
        }
        
        // æµ‹è¯•å‡½æ•° - ç‚¹å‡»è¿™é‡Œå¯ä»¥æ¨¡æ‹Ÿå®Œæˆæµ‹è¯•
        function testSelectAnswer() {
            // æµ‹è¯•é€‰æ‹©ç¬¬ä¸€é¢˜çš„é€‰é¡¹
            hollandTest.selectAnswer(1, 3);
            console.log('æµ‹è¯•ï¼šé€‰æ‹©äº†é¢˜ç›®1ï¼Œå€¼ä¸º3');
        }
    </script>
</body>
</html>
